%h2 Listing diagrams

#create_diagram_link
  = link_to 'Create a New Diagram', new_diagram_path, :style => "font-size: x-large;"

%table.datatable.responsive.no-wrap
  %thead
    %tr
      %th Name
      %th Category
      %th Creator
      %th
  %tbody
    - @diagrams.each do |diagram|
      %tr
        %td= link_to diagram.name, diagram
        %td= diagram.category
        %td= diagram.creator == current_user ? "Me": diagram.creator.name
        %td.diagram_controls{:id => "control_cell_#{diagram.id}"}
          %ul.control_menu{:id => "control_menu_#{diagram.id}", :style => "display:none;"}
            %li= link_to 'Show', diagram
            - if policy(diagram).download?
              %li
                Download
                %ul
                  - diagram.data_files.each do |df|
                    %li= link_to "Download #{df.name}", download_diagram_path(diagram, :data_file_id => df.id)
            - if policy(diagram).edit?
              %li= link_to 'Edit', edit_diagram_path(diagram)
            - if policy(diagram).destroy?
              %li= link_to 'Destroy', diagram, :method => :delete, :data => { :confirm => 'Are you sure?' }
  %br

:javascript
  $(".control_menu").each(function(){
    $(this).slicknav({
      prependTo: ("#control_cell_"+$(this).attr("id").split("_")[2]),
      label: "Actions",
      duration: 50
    });
  });


